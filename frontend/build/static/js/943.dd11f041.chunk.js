"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[943],{8943:function(e,t,n){n.r(t),n.d(t,{default:function(){return z}});var s=n(1413),r=n(70885),a=n(72791),i=n(16030),l=n(16871),o=n(56960),c=n(15861),u=n(87757),d=n.n(u),f=n(74569),x=n.n(f),m=n(45195),h=function(e){return function(){var t=(0,c.Z)(d().mark((function t(n){var s,r,a;return d().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,n({type:m.vn}),s={header:{"Content-Type":"application/json"}},t.next=5,x().post("/api/v1/newMessage/",e,s);case 5:r=t.sent,a=r.data,n({type:m.Ci,payload:a}),t.next=13;break;case 10:t.prev=10,t.t0=t.catch(0),n({type:m.qh,payload:t.t0.response.data.message});case 13:case"end":return t.stop()}}),t,null,[[0,10]])})));return function(e){return t.apply(this,arguments)}}()},p=n(37689),g=n(53585),v=n(96346),j=n(43504),w=n(59427),y=n(80184),N=function(e){var t=e._id,n=e.users,s=e.latestMessage,o=((0,i.I0)(),(0,l.UO)()),c=(0,a.useState)({}),u=(0,r.Z)(c,2),d=u[0],f=u[1],x=(0,a.useRef)(null),m=(0,a.useState)(!1),h=(0,r.Z)(m,2),p=h[0],v=h[1],N=(0,i.v9)((function(e){return e.user})).user;return(0,a.useEffect)((function(){var e=n.find((function(e){return e._id!==N._id}));f(e)}),[n]),(0,a.useEffect)((function(){x.current=(0,w.io)(g.Q)}),[]),(0,a.useEffect)((function(){x.current.on("getUsers",(function(e){v(e.some((function(e){return e.userId===d._id})))}))}),[d._id]),(0,y.jsxs)(j.rU,{to:"/direct/t/".concat(t,"/").concat(d._id),className:"".concat(o.chatId===t&&"bg-gray-100"," flex gap-3 items-center py-2 px-4 cursor-pointer hover:bg-gray-100"),children:[(0,y.jsxs)("div",{className:"w-14 h-14 relative",children:[(0,y.jsx)("img",{draggable:"false",className:"w-full h-full rounded-full object-cover",src:d.avatar,alt:"avatar"}),p&&(0,y.jsx)("div",{className:"absolute right-0 bottom-0.5 h-3 w-3 bg-green-500 rounded-full"})]}),(0,y.jsxs)("div",{className:"flex flex-col items-start",children:[(0,y.jsx)("span",{className:"text-sm",children:d.name}),(0,y.jsx)("span",{className:"text-sm truncate w-36 text-gray-400",children:null===s||void 0===s?void 0:s.content})]})]})},b=(n(56503),function(e){var t=e.openModal,n=(e.socket,(0,i.I0)()),r=(0,l.UO)(),c=(0,i.v9)((function(e){return e.user})).user,u=(0,i.v9)((function(e){return e.allChats})),d=(u.loading,u.error),f=u.chats;return(0,a.useEffect)((function(){d&&(o.Am.error(d),n((0,v.b9)())),n((0,v.BB)())}),[n,d,r.chatId]),(0,y.jsx)(y.Fragment,{children:(0,y.jsxs)("div",{className:"hidden sm:flex flex-col h-full w-2/6 border-r",children:[(0,y.jsxs)("div",{className:"flex items-center justify-between border-b p-4",children:[(0,y.jsx)("span",{className:"mx-auto font-medium cursor-pointer",children:c.username}),(0,y.jsxs)("svg",{onClick:t,className:"cursor-pointer","aria-label":"New Message",color:"#262626",fill:"#262626",height:"24",role:"img",viewBox:"0 0 24 24",width:"24",children:[(0,y.jsx)("path",{d:"M12.202 3.203H5.25a3 3 0 00-3 3V18.75a3 3 0 003 3h12.547a3 3 0 003-3v-6.952",fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2"}),(0,y.jsx)("path",{d:"M10.002 17.226H6.774v-3.228L18.607 2.165a1.417 1.417 0 012.004 0l1.224 1.225a1.417 1.417 0 010 2.004z",fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2"}),(0,y.jsx)("line",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",x1:"16.848",x2:"20.076",y1:"3.924",y2:"7.153"})]})]}),(0,y.jsxs)("div",{className:"flex flex-col overflow-y-auto overflow-x-hidden",children:[(0,y.jsx)("span",{className:"px-4 py-2 font-medium",children:"Messages"}),null===f||void 0===f?void 0:f.map((function(e){return(0,a.createElement)(N,(0,s.Z)((0,s.Z)({},e),{},{key:e._id}))}))]})]})})}),k=function(e){var t=e.ownMsg,n=e.avatar,s=e.content;return t?"\u2764\ufe0f"===s?(0,y.jsx)("span",{className:"self-end text-4xl",children:s}):(0,y.jsx)("span",{className:"self-end text-sm text-white bg-violet-600 px-4 py-3 rounded-3xl max-w-xs",children:s}):"\u2764\ufe0f"===s?(0,y.jsxs)("div",{className:"flex items-end gap-2 max-w-xs",children:[(0,y.jsx)("img",{draggable:"false",className:"w-7 h-7 rounded-full object-cover",src:n,alt:"avatar"}),(0,y.jsx)("span",{className:"items-end text-4xl",children:s})]}):(0,y.jsxs)("div",{className:"flex items-end gap-2 max-w-xs",children:[(0,y.jsx)("img",{draggable:"false",className:"w-7 h-7 rounded-full object-cover",src:n,alt:"avatar"}),(0,y.jsx)("span",{className:"px-4 py-3 text-sm bg-gray-200 rounded-3xl max-w-xs overflow-hidden",children:s})]})},C=n(48950),M=n(29818),Z=n(49283),I=n(47047),S=function(e){var t=e.open,n=e.onClose,s=(0,i.I0)(),u=(0,l.s0)(),f=(0,a.useState)([]),m=(0,r.Z)(f,2),h=m[0],p=m[1],g=(0,a.useState)(""),j=(0,r.Z)(g,2),w=j[0],N=j[1],b=(0,a.useState)(!1),k=(0,r.Z)(b,2),C=k[0],S=k[1],_=(0,i.v9)((function(e){return e.user})).user,L=(0,i.v9)((function(e){return e.newChat})),E=L.error,z=L.chat,A=function(){var e=(0,c.Z)(d().mark((function e(t){var n,s;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return S(!0),e.next=3,x().get("/api/v1/users?keyword=".concat(t));case 3:n=e.sent,s=n.data,p(s.users.filter((function(e){return e._id!==_._id}))),S(!1);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();(0,a.useEffect)((function(){return w.trim().length>0&&A(w),function(){p([])}}),[w]);return(0,a.useEffect)((function(){if(E&&(o.Am.error(E),s((0,v.b9)())),z){var e,t=null===(e=z.users)||void 0===e?void 0:e.find((function(e){return e!==_._id}));u("/direct/t/".concat(z._id,"/").concat(t)),s({type:Z.X0}),n()}}),[s,E,z,u]),(0,y.jsx)(M.Z,{open:t,onClose:n,children:(0,y.jsxs)("div",{className:"flex flex-col w-80 sm:w-96",children:[(0,y.jsxs)("div",{className:"flex justify-between items-center px-4 border-b py-2.5",children:[(0,y.jsx)("span",{className:"font-medium mx-auto",children:"New Message"}),(0,y.jsxs)("svg",{onClick:n,className:"cursor-pointer","aria-label":"Close",color:"#262626",fill:"#262626",height:"24",role:"img",viewBox:"0 0 24 24",width:"24",children:[(0,y.jsx)("line",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",x1:"21",x2:"3",y1:"3",y2:"21"}),(0,y.jsx)("line",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",x1:"21",x2:"3",y1:"21",y2:"3"})]})]}),(0,y.jsxs)("div",{className:"flex items-center gap-3 border-b p-3",children:[(0,y.jsx)("span",{className:"font-medium",children:"To:"}),(0,y.jsx)("input",{className:"outline-none w-full",type:"text",placeholder:"Search User..",value:w,onChange:function(e){return N(e.target.value)}})]}),(0,y.jsx)("div",{className:"flex flex-col overflow-x-hidden h-96 w-full",children:C?Array(8).fill("").map((function(e,t){return(0,y.jsxs)("div",{className:"flex items-center gap-2 py-2 px-4",children:[(0,y.jsx)(I.Z,{animation:"wave",variant:"circular",width:60,height:50}),(0,y.jsxs)("div",{className:"flex flex-col gap-0 w-full",children:[(0,y.jsx)(I.Z,{height:23,width:"45%",animation:"wave"}),(0,y.jsx)(I.Z,{height:23,width:"30%",animation:"wave"})]})]},t)})):h.length>0?h.map((function(e){return(0,y.jsx)("div",{onClick:function(){return t=e._id,s((0,v.rz)(t)),void N("");var t},className:"flex items-center hover:bg-gray-50 py-2 px-4 cursor-pointer",children:(0,y.jsxs)("div",{className:"flex space-x-3 items-center",children:[(0,y.jsx)("img",{draggable:"false",className:"w-11 h-11 rounded-full object-cover",src:e.avatar,alt:"avatar"}),(0,y.jsxs)("div",{className:"flex flex-col items-start",children:[(0,y.jsx)("span",{className:"text-black text-sm font-semibold",children:e.username}),(0,y.jsx)("span",{className:"text-gray-400 text-sm",children:e.name})]})]})},e._id)})):(0,y.jsx)("span",{className:"text-gray-400 text-sm p-2",children:"No accounts found."})})]})})},_=n(73356),L=n(6038),E=n(38278),z=function(){var e=(0,i.I0)(),t=(0,l.UO)(),n=(0,a.useState)(""),u=(0,r.Z)(n,2),f=u[0],v=u[1],j=(0,a.useState)(null),N=(0,r.Z)(j,2),M=N[0],Z=N[1],I=(0,a.useRef)(null),z=(0,a.useRef)(null),A=(0,a.useState)(!1),W=(0,r.Z)(A,2),B=W[0],U=W[1],F=(0,a.useState)(!1),R=(0,r.Z)(F,2),T=R[0],D=R[1],V=(0,a.useState)({}),H=(0,r.Z)(V,2),O=H[0],Q=H[1],q=(0,a.useState)(!1),J=(0,r.Z)(q,2),P=J[0],X=J[1],Y=(0,a.useState)(!1),$=(0,r.Z)(Y,2),G=$[0],K=$[1],ee=(0,a.useState)(!1),te=(0,r.Z)(ee,2),ne=te[0],se=te[1],re=(0,i.v9)((function(e){return e.user})).user,ae=(0,i.v9)((function(e){return e.userDetails})).user,ie=(0,i.v9)((function(e){return e.allMessages})),le=ie.error,oe=ie.messages,ce=ie.loading,ue=(0,i.v9)((function(e){return e.newMessage})),de=ue.success,fe=ue.newMessage,xe=t.userId;(0,a.useEffect)((function(){z.current=(0,w.io)(g.Q),z.current.on("getMessage",(function(e){Z({sender:e.senderId,content:e.content,createdAt:Date.now()})})),z.current.on("typing",(function(e){Q({senderId:e,typing:!0})})),z.current.on("typing stop",(function(e){Q({senderId:e,typing:!1})}))}),[]),(0,a.useEffect)((function(){O&&O.senderId===xe&&D(O.typing)}),[O,xe]),(0,a.useEffect)((function(){M&&M.sender===xe&&e({type:m._w,payload:M})}),[M,xe]),(0,a.useEffect)((function(){z.current.emit("addUser",re._id),z.current.on("getUsers",(function(e){X(e.some((function(e){return e.userId===xe})))}))}),[re._id,xe]),(0,a.useEffect)((function(){var n;return le&&(o.Am.error(le),e((function(e){e({type:m.pp})}))),t.chatId&&xe&&(e((n=t.chatId,function(){var e=(0,c.Z)(d().mark((function e(t){var s,r;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t({type:m.hJ}),e.next=4,x().get("/api/v1/messages/".concat(n));case 4:s=e.sent,r=s.data,t({type:m.$t,payload:r.messages}),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),t({type:m.MQ,payload:e.t0.response.data.message});case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(t){return e.apply(this,arguments)}}())),e((0,p.uh)(xe))),function(){e({type:E.uW})}}),[e,le,t.chatId,xe]),(0,a.useEffect)((function(){de&&(e({type:m._w,payload:fe}),e({type:m.ME}))}),[e,de]);var me=function(n){var s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:f;n.preventDefault(),null===z||void 0===z||z.current.emit("sendMessage",{senderId:re._id,receiverId:xe,content:s});var r={chatId:t.chatId,content:s};e(h(r)),v("")};(0,a.useEffect)((function(){var e;null===(e=I.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})}),[oe]);var he=function(){se(!0)};return(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(L.Z,{title:"Instagram \u2022 Chats"}),(0,y.jsxs)("div",{className:"mt-14 sm:mt-[4.7rem] pb-4 rounded h-[90vh] xl:w-2/3 mx-auto sm:pr-14 sm:pl-8",children:[(0,y.jsxs)("div",{className:"flex border h-full rounded w-full bg-white",children:[(0,y.jsx)(b,{openModal:he}),xe?(0,y.jsxs)("div",{className:"flex flex-col justify-between w-full sm:w-4/6",children:[(0,y.jsxs)("div",{className:"flex py-3 px-6 border-b items-center justify-between",children:[(0,y.jsxs)("div",{className:"flex gap-2 items-center",children:[(0,y.jsxs)("div",{className:"w-8 h-8 relative",children:[(0,y.jsx)("img",{draggable:"false",loading:"lazy",className:"w-full h-full rounded-full object-cover",src:ae.avatar,alt:"avatar"}),P&&(0,y.jsx)("div",{className:"absolute -right-0.5 -bottom-0.5 h-3 w-3 bg-green-500 rounded-full"})]}),(0,y.jsx)("span",{className:"font-medium cursor-pointer",children:ae.name})]}),(0,y.jsxs)("svg",{className:"cursor-pointer","aria-label":"View Thread Details",color:"#262626",fill:"#262626",height:"24",role:"img",viewBox:"0 0 24 24",width:"24",children:[(0,y.jsx)("circle",{cx:"12.001",cy:"12.005",fill:"none",r:"10.5",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2"}),(0,y.jsx)("circle",{cx:"11.819",cy:"7.709",r:"1.25"}),(0,y.jsx)("line",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",x1:"10.569",x2:"13.432",y1:"16.777",y2:"16.777"}),(0,y.jsx)("polyline",{fill:"none",points:"10.569 11.05 12 11.05 12 16.777",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2"})]})]}),(0,y.jsxs)("div",{className:"w-full flex-1 flex flex-col gap-1.5 overflow-y-auto overflow-x-hidden p-4",children:[ce?(0,y.jsx)(_.Z,{}):oe.map((function(e,t){return(0,y.jsxs)(a.Fragment,{children:[(0,y.jsx)(k,(0,s.Z)((0,s.Z)({ownMsg:e.sender===re._id},ae),e)),(0,y.jsx)("div",{ref:I})]},e._id)})),T&&(0,y.jsxs)(y.Fragment,{children:[(0,y.jsxs)("div",{className:"flex items-center gap-3 max-w-xs",children:[(0,y.jsx)("img",{draggable:"false",loading:"lazy",className:"w-7 h-7 rounded-full object-cover",src:ae.avatar,alt:"avatar"}),(0,y.jsx)("span",{className:"text-sm text-gray-500",children:"typing..."})]}),(0,y.jsx)("div",{ref:I})]})]}),(0,y.jsxs)("form",{onSubmit:me,className:"flex items-center gap-3 justify-between border rounded-full py-2.5 px-4 m-5 relative",children:[(0,y.jsx)("span",{onClick:function(){return K(!G)},className:"cursor-pointer hover:opacity-60",children:(0,y.jsx)("svg",{"aria-label":"Emoji",color:"#262626",fill:"#262626",height:"24",role:"img",viewBox:"0 0 24 24",width:"24",children:(0,y.jsx)("path",{d:"M15.83 10.997a1.167 1.167 0 101.167 1.167 1.167 1.167 0 00-1.167-1.167zm-6.5 1.167a1.167 1.167 0 10-1.166 1.167 1.167 1.167 0 001.166-1.167zm5.163 3.24a3.406 3.406 0 01-4.982.007 1 1 0 10-1.557 1.256 5.397 5.397 0 008.09 0 1 1 0 00-1.55-1.263zM12 .503a11.5 11.5 0 1011.5 11.5A11.513 11.513 0 0012 .503zm0 21a9.5 9.5 0 119.5-9.5 9.51 9.51 0 01-9.5 9.5z"})})}),G&&(0,y.jsx)("div",{className:"absolute bottom-14 -left-10",children:(0,y.jsx)(C.cW,{set:"google",onSelect:function(e){return v(f+e.native)},title:"Emojis"})}),(0,y.jsx)("input",{className:"flex-1 outline-none text-sm",type:"text",placeholder:"Message...",value:f,onFocus:function(){return K(!1)},onChange:function(e){v(e.target.value),B||(U(!0),null===z||void 0===z||z.current.emit("typing",{senderId:re._id,receiverId:xe})),setTimeout((function(){null===z||void 0===z||z.current.emit("typing stop",{senderId:re._id,receiverId:xe}),U(!1)}),2e3)},required:!0}),f.trim().length>0?(0,y.jsx)("button",{className:"text-primary-blue font-medium text-sm",children:"Send"}):(0,y.jsxs)(y.Fragment,{children:[(0,y.jsxs)("svg",{className:"cursor-pointer","aria-label":"Add Photo or Video",color:"#262626",fill:"#262626",height:"24",role:"img",viewBox:"0 0 24 24",width:"24",children:[(0,y.jsx)("path",{d:"M6.549 5.013A1.557 1.557 0 108.106 6.57a1.557 1.557 0 00-1.557-1.557z",fillRule:"evenodd"}),(0,y.jsx)("path",{d:"M2 18.605l3.901-3.9a.908.908 0 011.284 0l2.807 2.806a.908.908 0 001.283 0l5.534-5.534a.908.908 0 011.283 0l3.905 3.905",fill:"none",stroke:"currentColor",strokeLinejoin:"round",strokeWidth:"2"}),(0,y.jsx)("path",{d:"M18.44 2.004A3.56 3.56 0 0122 5.564h0v12.873a3.56 3.56 0 01-3.56 3.56H5.568a3.56 3.56 0 01-3.56-3.56V5.563a3.56 3.56 0 013.56-3.56z",fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2"})]}),(0,y.jsx)("svg",{onClick:function(e){return me(e,"\u2764\ufe0f")},className:"hover:opacity-70 cursor-pointer","aria-label":"Like",color:"#262626",fill:"#262626",height:"24",role:"img",viewBox:"0 0 24 24",width:"24",children:(0,y.jsx)("path",{d:"M16.792 3.904A4.989 4.989 0 0121.5 9.122c0 3.072-2.652 4.959-5.197 7.222-2.512 2.243-3.865 3.469-4.303 3.752-.477-.309-2.143-1.823-4.303-3.752C5.141 14.072 2.5 12.167 2.5 9.122a4.989 4.989 0 014.708-5.218 4.21 4.21 0 013.675 1.941c.84 1.175.98 1.763 1.12 1.763s.278-.588 1.11-1.766a4.17 4.17 0 013.679-1.938m0-2a6.04 6.04 0 00-4.797 2.127 6.052 6.052 0 00-4.787-2.127A6.985 6.985 0 00.5 9.122c0 3.61 2.55 5.827 5.015 7.97.283.246.569.494.853.747l1.027.918a44.998 44.998 0 003.518 3.018 2 2 0 002.174 0 45.263 45.263 0 003.626-3.115l.922-.824c.293-.26.59-.519.885-.774 2.334-2.025 4.98-4.32 4.98-7.94a6.985 6.985 0 00-6.708-7.218z"})})]})]})]}):(0,y.jsxs)("div",{className:"flex flex-col items-center justify-center w-full sm:w-4/6 gap-2",children:[(0,y.jsx)("div",{className:"w-24 h-24 flex items-center p-2 justify-center border-2 border-black rounded-full",children:(0,y.jsx)("img",{draggable:"false",loading:"lazy",className:"w-full h-full rotate-12 object-contain",src:"https://static.thenounproject.com/png/172101-200.png",alt:"message"})}),(0,y.jsx)("h2",{className:"text-2xl font-thin",children:"Your Messages"}),(0,y.jsx)("p",{className:"text-gray-400 text-sm",children:"Send private photos and messages to a friend or group."}),(0,y.jsx)("button",{onClick:he,className:"bg-primary-blue rounded px-2.5 mt-2 py-1.5 text-white text-sm font-medium hover:drop-shadow-lg",children:"Send Message"})]})]}),(0,y.jsx)(S,{open:ne,onClose:function(){se(!1)}})]})]})}},56503:function(e,t,n){var s=n(47047),r=n(80184);t.Z=function(){return(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)(s.Z,{animation:"wave",variant:"circular",width:45,height:40}),(0,r.jsxs)("div",{className:"flex flex-col gap-1 w-full",children:[(0,r.jsx)(s.Z,{height:15,variant:"rectangular",width:"60%",animation:"wave"}),(0,r.jsx)(s.Z,{height:12,variant:"rectangular",width:"30%",animation:"wave"})]})]})}},53585:function(e,t,n){n.d(t,{O:function(){return r},Q:function(){return s}});var s="https://instagrammern.herokuapp.com",r=[{title:"JavaScript",image:"javascript"},{title:"Node.js",image:"nodejs"},{title:"Express.js",image:"expressjs"},{title:"MongoDB",image:"mongodb"},{title:"React.js",image:"reactjs"},{title:"Socket.io",image:"socketio"},{title:"TailwindCSS",image:"tailwind"},{title:"Heroku",image:"heroku"},{title:"MaterialUI",image:"mui"},{title:"Redux",image:"redux"},{title:"Multer",image:"multer"},{title:"AWS S3",image:"aws-s3"},{title:"Sendgrid",image:"sendgrid"},{title:"Axios",image:"axios"},{title:"Toastify",image:"toastify"}]}}]);
//# sourceMappingURL=943.dd11f041.chunk.js.map